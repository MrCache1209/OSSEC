<!--

	Last update on 02/06/2022 by Dhruv Patel

-->

<agent_config>
    <syscheck>

      <!-- Frequency that syscheck is executed - default to every 24 hours -->
      <frequency>86400</frequency>
      <scan_day>Monday,Tuesday,Wednesday,Thursday,Friday,Saturday,Sunday</scan_day>
      <scan_time>01:00</scan_time>

      <!-- Ignore files that change too often (after the third change) -->
      <auto_ignore>yes</auto_ignore>

      <!-- Don't ignore files that are created in the monitored directories -->
      <alert_new_files>yes</alert_new_files>
      <!-- see http://ossec-docs.readthedocs.io/en/latest/faq/syscheck.html -->

      <!-- Don't scan each time the agent starts (or restarts) -->
      <scan_on_start>no</scan_on_start>

      <!--
                        Linux directories to check  (perform all possible verifications)

                        -->

      <directories check_all="yes">/boot,/lib,/lib64,/sys,/usr/local/bin,/usr/local/etc,/usr/local/sbin</directories>
      <directories check_all="yes">/var/ossec/etc,/var/ossec/bin,/var/ossec/ossec-agent/etc</directories>
      
	  <!-- Linux files to ignore -->
	  <ignore>/sys/kernel/fs</ignore>
      <ignore>/sys/devices</ignore>
      <ignore>/sys/kernel/slab</ignore>
      <ignore>/sys/kernel/irq</ignore>
      <ignore>/etc/motd</ignore>
      <ignore>/etc/passwd</ignore>
      <ignore>/etc/mtab</ignore>
      <ignore>/etc/hosts.deny</ignore>
      <ignore>/etc/mail/statistics</ignore>
      <ignore>/etc/random-seed</ignore>
      <ignore>/etc/random.seed</ignore>
      <ignore>/etc/adjtime</ignore>
      <ignore>/etc/httpd/logs</ignore>
      <ignore>/etc/utmpx</ignore>
      <ignore>/etc/wtmpx</ignore>
      <ignore>/etc/cups/certs</ignore>
      <ignore>/etc/dumpdates</ignore>
      <ignore>/etc/svc/volatile</ignore>

      <!--
                        Windows Directories to check  (perform all possible verifications)

                        -->

      <directories check_all="yes">%WINDIR%/system32</directories>

      <!-- Windows files to ignore -->
      <ignore>%WINDIR%/system32/dllcache</ignore>
      <ignore>%WINDIR%/system32/inetsrv/History</ignore>
      <ignore>%WINDIR%/system32/LogFiles</ignore>
      <ignore type="sregex">.log$|.htm$|.jpg$|.png$|.chm$|.pnf$|.mdb$|.jfm$</ignore>
      
      <!-- Windows registry entries to monitor -->
      <windows_registry>HKEY_LOCAL_MACHINE\Software\Policies</windows_registry>
      <windows_registry>HKEY_LOCAL_MACHINE\Software\Microsoft\Windows NT\CurrentVersion</windows_registry>
      <windows_registry>HKEY_LOCAL_MACHINE\Software\Microsoft\Windows\CurrentVersion</windows_registry>
      <windows_registry>HKEY_LOCAL_MACHINE\Software\Microsoft\Internet Explorer</windows_registry>
      <windows_registry>HKEY_LOCAL_MACHINE\Software\Classes</windows_registry>
      <windows_registry>HKEY_LOCAL_MACHINE\System\CurrentControlSet\Control</windows_registry>
      <windows_registry>HKEY_LOCAL_MACHINE\System\CurrentControlSet\Services</windows_registry>
      <windows_registry>HKEY_LOCAL_MACHINE\Security</windows_registry>
      
      <!-- Windows registry entries to ignore -->
      <registry_ignore>HKEY_LOCAL_MACHINE\Software\Microsoft\Windows\CurrentVersion\Installer\UserData</registry_ignore>
      <registry_ignore>HKEY_LOCAL_MACHINE\Software\Microsoft\Windows\CurrentVersion\Group Policy\State</registry_ignore>
      <registry_ignore>HKEY_LOCAL_MACHINE\Software\Microsoft\Windows\CurrentVersion\WindowsUpdate</registry_ignore>
      <registry_ignore>HKEY_LOCAL_MACHINE\Software\Microsoft\Windows\CurrentVersion\Internet Settings\Cache</registry_ignore>
      <registry_ignore>HKEY_LOCAL_MACHINE\Software\Microsoft\Windows NT\CurrentVersion\ProfileList</registry_ignore>
      <registry_ignore>HKEY_LOCAL_MACHINE\Software\Microsoft\Windows NT\CurrentVersion\Prefetcher</registry_ignore>
      <registry_ignore>HKEY_LOCAL_MACHINE\Software\Classes\Interface</registry_ignore>
      <registry_ignore>HKEY_LOCAL_MACHINE\Software\Classes\TypeLib</registry_ignore>
      <registry_ignore>HKEY_LOCAL_MACHINE\Software\Classes\MIME</registry_ignore>
      <registry_ignore>HKEY_LOCAL_MACHINE\Software\Classes\Software</registry_ignore>
      <registry_ignore>HKEY_LOCAL_MACHINE\Software\Classes\CLSID</registry_ignore>
      <registry_ignore>HKEY_LOCAL_MACHINE\Security\Policy\Secrets</registry_ignore>
      <registry_ignore>HKEY_LOCAL_MACHINE\Security\SAM\Domains\Account\Users</registry_ignore>
      <registry_ignore>HKEY_LOCAL_MACHINE\System\CurrentControlSet\Control\DeviceClasses</registry_ignore>
      <registry_ignore>HKEY_LOCAL_MACHINE\System\CurrentControlSet\Control\Watchdog</registry_ignore>
      <registry_ignore>HKEY_LOCAL_MACHINE\System\CurrentControlSet\Control\MediaCategories</registry_ignore>
      <registry_ignore>HKEY_LOCAL_MACHINE\System\CurrentControlSet\Control\Windows</registry_ignore>
      <registry_ignore>HKEY_LOCAL_MACHINE\System\CurrentControlSet\Control\hivelist</registry_ignore>
      <registry_ignore>HKEY_LOCAL_MACHINE\System\CurrentControlSet\Control\ServiceCurrent</registry_ignore>
      <registry_ignore>HKEY_LOCAL_MACHINE\System\CurrentControlSet\Control\Print</registry_ignore>
      <registry_ignore>HKEY_LOCAL_MACHINE\System\CurrentControlSet\Control\SessionManager</registry_ignore>
      <registry_ignore>HKEY_LOCAL_MACHINE\System\CurrentControlSet\Services\Eventlog</registry_ignore>
      <registry_ignore>HKEY_LOCAL_MACHINE\System\CurrentControlSet\Services\RemoteAccess\Performance</registry_ignore>
      <registry_ignore>HKEY_LOCAL_MACHINE\System\CurrentControlSet\Services\W32Time\TimeProviders\NtpClient</registry_ignore>
      <registry_ignore type="sregex">\Enum$</registry_ignore>
    </syscheck>
</agent_config>
