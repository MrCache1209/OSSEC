<ossec_config>
  <global>
    <!-- disable email notification -->
    <email_notification>no</email_notification>
    <custom_alert_output>Alert Level: $RULELEVEL; Rule: $RULEID - $RULECOMMENT; Location: $LOCATION; classification:  $RULEGROUP; $FULLLOG</custom_alert_output>
  </global>

  <rules>
    <include>rules_config.xml</include>
    <include>ossec_rules.xml</include>
  </rules>

  <!-- syscheck aka FIM setup -->
  <syscheck>
      <!-- Frequency that syscheck is executed - default to every 24 hours -->
      <frequency>86400</frequency>
      <scan_day>Monday,Tuesday,Wednesday,Thursday,Saturday,Sunday</scan_day>
      <scan_time>01:00</scan_time>
      
	  <!-- Ignore files that change too often (after the third change) -->
      <auto_ignore>yes</auto_ignore>
      
	  <!-- Don't ignore files that are created in the monitored directories -->
      <alert_new_files>yes</alert_new_files>
      <!-- see http://ossec-docs.readthedocs.io/en/latest/faq/syscheck.html -->
      <!-- Scan each time the agent starts (or restarts) -->
      
	  <scan_on_start>no</scan_on_start>

      <!--
                        Linux directories to check  (perform all possible verifications)

                        -->

      <directories check_all="yes">/boot,/lib,/lib64,/sys,/usr/local/bin,/usr/local/etc,/usr/local/sbin</directories>
      <directories check_all="yes">/var/ossec/etc,/var/ossec/bin,/var/ossec/ossec-agent/etc</directories>
      
	  <!-- Linux files to ignore -->
	  <ignore>/sys/kernel/fs</ignore>
      <ignore>/etc/motd</ignore>
      <ignore>/etc/passwd</ignore>
      <ignore>/etc/mtab</ignore>
      <ignore>/etc/hosts.deny</ignore>
      <ignore>/etc/mail/statistics</ignore>
      <ignore>/etc/random-seed</ignore>
      <ignore>/etc/random.seed</ignore>
      <ignore>/etc/adjtime</ignore>
      <ignore>/etc/httpd/logs</ignore>
      <ignore>/etc/utmpx</ignore>
      <ignore>/etc/wtmpx</ignore>
      <ignore>/etc/cups/certs</ignore>
      <ignore>/etc/dumpdates</ignore>
      <ignore>/etc/svc/volatile</ignore>
  </syscheck>

  <rootcheck>
    <disabled>yes</disabled>
  </rootcheck>

  <!-- The Active Response feature within OSSEC can run applications on an agent or server in response to certain triggers. These triggers can be specific alerts, alert levels, or rule groups.
  The active response framework is also what allows an OSSEC administrator to start a syscheck scan or restart OSSEC on a remote agent. -->
  <command>
    <name>host-deny</name>
    <executable>host-deny.sh</executable>
    <expect>srcip</expect>
    <timeout_allowed>yes</timeout_allowed>
  </command>

  <active-response>
    <!-- This response is going to execute the host-deny
       - command for every event that fires a rule with
       - level (severity) >= 6.
       - The IP is going to be blocked for  600 seconds.
      -->
    <command>host-deny</command>
    <location>local</location>
    <level>6</level>
    <timeout>600</timeout>
  </active-response>

  <remote>
    <connection>secure</connection>
  </remote>

  <alerts>
    <log_alert_level>1</log_alert_level>
  </alerts>

  <!-- Files to monitor (localfiles) -->
  <!-- won't monitor local files as don't want to send these events -->

</ossec_config>